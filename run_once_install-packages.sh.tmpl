#!/usr/bin/env zsh
# vi: ft=zsh

export HOMEBREW_NO_ENV_HINTS=TRUE

brew_install() {
  echo "\nInstalling $1"
  if brew list $1 &>/dev/null; then
    echo "${1} is already installed"
  else
    brew install $1
  fi
}

# antigen
[[ -f ~/.antigen.zsh ]] || curl -L git.io/antigen > ~/.antigen.zsh

# homebrew
brews=(
  age
  autojump
  bitwarden-cli
  cilium-cli
  grc
  helm
  helmfile
  k0s
  k0sctl
  k9s
  kustomize
  neovim
  sops
  zsh-completions
)

installedbrews=$(brew list)

#for brew ($brews) [[ ! ${installedbrews[@]} =~ ${brew} ]] || brew_install ${brew} end
for brew in "$brews[@]"; do
 if [[ ! ${installedbrews[(ie)${brew}]} -lt ${#installedbrews} ]]; then
  brew install ${brew}
 fi
  
done

{{ if eq .chezmoi.os "darwin" -}}
# Fonts on MacOS
brew_install font-hack-nerd-font
brew_install font-caskaydia-cove-nerd-font
{{ end -}}

# powerlevel10k theme
[ -d $HOME/.oh-my-zsh/custom/themes/powerlevel10k ] || git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
