#!/usr/bin/env zsh
# vi: ft=zsh

export HOMEBREW_NO_ENV_HINTS=TRUE

# antigen
[ -f ~/.antigen.zsh ] || curl -L git.io/antigen > ~/.antigen.zsh

# homebrew
brews=(
  age
  argocd
  autoenv
  autojump
  bitwarden-cli
  cilium-cli
  direnv
  grc
  gum
  helm
  helmfile
  k0sctl
  k9s
  kustomize
  neovim
  sops
  task
  tasksh
  taskwarrior-tui
  zsh-completions
)

installedbrews=$(brew list)

#for brew ($brews) [[ ! ${installedbrews[@]} =~ ${brew} ]] || brew_install ${brew} end
for brew in "$brews[@]"; do
 if [[ ${installedbrews[(ie)${brew}]} -lt ${#installedbrews} ]]; then
  if [ -e $(which gum) ]
  then 
    gum spin --title="brew install ${brew}" --show-error -- brew install --quiet ${brew}
  else 
    echo "brew install ${brew}"
    brew install --quiet ${brew}
  fi
 fi 
done

{{ if eq .chezmoi.os "darwin" -}}
# Fonts on MacOS
brew_install font-hack-nerd-font
brew_install font-caskaydia-cove-nerd-font
{{ end -}}

# powerlevel10k theme
[ -d $HOME/.oh-my-zsh/custom/themes/powerlevel10k ] || git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k
